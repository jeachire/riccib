<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parameter estimation of the Ricci distribution using Jeffrey's prior. — riccibo • riccib</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Parameter estimation of the Ricci distribution using Jeffrey's prior. — riccibo"><meta property="og:description" content="This function estimates the parameters of the Ricci distribution from
a sample and using Jeffrey's prior."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riccib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jeachire/riccib" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parameter estimation of the Ricci distribution using Jeffrey's prior.</h1>
    
    <div class="hidden name"><code>riccibo.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the parameters of the Ricci distribution from
a sample and using Jeffrey's prior.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">riccibo</span><span class="op">(</span><span class="va">x</span>, <span class="va">R</span>, <span class="va">burn</span>, <span class="va">jump</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A vector of values to which you want to fit the Ricci model.</p></dd>


<dt>R</dt>
<dd><p>Number of samples in the chain (including burned samples).</p></dd>


<dt>burn</dt>
<dd><p>A positive integer specifying number of warmup
samples. This also specifies the number of samples used
for stepsize adaptation, so warmup draws should not be used
for inference. The number of warmup should not be larger than
R.</p></dd>


<dt>jump</dt>
<dd><p>Thinning rate. Must be a positive integer.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing the following estimates:</p>
<dl><dt>acep</dt>
<dd><p>Acceptance rate in the metropolis hastings
algorithm.</p></dd>

<dt>eta</dt>
<dd><p>Point estimate for the eta parameter.</p></dd>

<dt>alpha</dt>
<dd><p>Point estimate for parameter alpha.</p></dd>

<dt>CIL_eta</dt>
<dd><p>Lower limit of the credibility
interval (95%) for the eta parameter.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>In this section, we outline the Monte Carlo Markov chain algorithm
for sampling from the joint posterior distribution.  To generate
samples of \(\eta\) and \(\alpha\) from the marginal posterior distribution,
the Metropolis-Hastings (MH) algorithm is required since the marginal
distributions do not have closed-form expressions. Therefore, in order
to obtain samples from the marginal distributions, we can use the
conditional distribution given by</p>
<p>\(
p_1(\eta|\alpha,\boldsymbol{x})\propto \sqrt{(\rho+1)\Psi(\rho)-
   \rho}\prod_{i=1}^{n}I_0\left( \frac{\eta x_i}{\alpha^2}
     \right) \exp\left( -\sum_{i=1}^{n}\frac{x_i^2 + \eta^2}
       {2\alpha^2} \right)\)</p>
<p>\(
p_2(\alpha|\eta,\boldsymbol{x})\propto\frac{\sqrt{(\rho+1)
\Psi(\rho)-\rho}}{\alpha^{2n+2}}\prod_{i=1}^{n}I_0\left( \frac
{\eta x_i}{\alpha^2} \right) \exp\left( -\sum_{i=1}^{n}\frac
{x_i^2 + \eta^2}{2\alpha^2} \right)\)</p>
<p>In this study, we adopt the Gamma distribution
\(q(\alpha^{(*)}|\alpha^{(j)},k)\) y \(q(\eta^{(*)}|\eta^{(j)},d)\)
 as a proposal distribution to sample values of the parameters
 \(\alpha\) and \(\eta\), respectively, where \(d\) and \(k\)
 are hyperparameters that influence the convergence rate of the
 algorithm. It is important to note that alternative proposal
 distributions can be utilized in place of the Gamma model,
 such as any model that generates values in the positive real
 line. The subsequent steps detail the execution of the MH
 algorithm:</p>
<p></p><ol><li><p>Compute the initial values of \(\eta^{(1)}\)
and \(\alpha^{(1)}\) from moment estimators and initialize
a counter \(j=1\);</p></li>
<li><p>Generate a random number \(\eta^{(*)}\) from the
\(Gamma(\eta^{(j)}, d)\) distribution;</p></li>
<li><p>Calculate the acceptance probability, defined as:</p>
<p>\(
\Delta\left(\eta^{(j)},\eta^{(*)}\right)=\min\left(1, \frac
{p_1\left(\eta^{(*)}|\alpha^{(j)},\boldsymbol{x}\right)}
{p_1\left(\eta^{(j)}|\alpha^{(j)},\boldsymbol{x}\right)}
\frac{q\left(\eta^{(j)}|\eta^{(*)},d\right)}{q
\left(\eta^{(*)}|\eta^{(j)},d\right)}\right)\)</p>
<p>Draw a random sample from an independent uniform distribution
\(u\) in the interval (0,1);</p></li>
<li><p>If \(\Delta\left(\eta^{(j)},\eta^{(*)}\right)\geq u(0,1)\),
accept the value \(\eta^{(*)}\) and set
\(\eta^{(j+1)}=\eta^{(*)}\).
If \(\Delta\left(\eta^{(j)},\eta^{(*)}\right)&lt; u(0,1)\),
reject the value and set \(\eta^{(j+1)}=\eta^{(j)}\);</p></li>
<li><p>Generate a random number \(\alpha^{(*)}\) from
the \(Gamma(\alpha^{(j)}, k)\) distribution;</p></li>
<li><p>Calculate the acceptance probability, defined as:
\(
\Delta\left(\alpha^{(j)},\alpha^{(*)}\right)=\min
\left(1, \frac{p_2\left(\alpha^{(*)}|\eta^{(j+1)},
\boldsymbol{x}\right)}{p_2\left(\alpha^{(j)}|\eta^{(j+1)},
\boldsymbol{x}\right)} \frac{q\left(\alpha^{(j)}|
\alpha^{(*)},k\right)}{q\left(\alpha^{(*)}|\alpha^{(j)},k
\right)}\right)\)</p>
<p>Draw a random sample from an independent uniform distribution
\(u\) in the interval (0,1);</p></li>
<li><p>If \(\Delta\left(\alpha^{(j)},\alpha^{(*)}\right)\geq u(0,1)\),
accept the value \(\alpha^{(*)}\) and set
\(\alpha^{(j+1)}=\alpha^{(*)}\).
If \(\Delta\left(\alpha^{(j)},\alpha^{(*)}\right)&lt; u(0,1)\),
reject the value and set \(\alpha^{(j+1)}=\alpha^{(j)}\);</p></li>
<li><p>Increment the counter (j) to (j+1) and repeat steps 2-7
until the chains converge.</p></li>
</ol><p>The implementation of the MCMC methodology detailed previously
facilitated the generation of 5,500 samples from the posterior
distributions. We excluded the initial 500 samples, considering
them as the burn-in phase, and applied a thinning process with
an interval of every 5 samples. This procedure resulted in two
separate chains, each containing \(1000\) samples, which were
utilized to derive the posterior statistical summaries. Initial
values for the simulation were determined using moment
estimators, which are known for their analytical solutions.</p>
<p>To assess the convergence of the Markov chains we produced,
a Geweke diagnostic was employed.
This diagnostic employs a method that compares the mean values
of the first \(10\%\) and the last \(50\%\) of a chain,
positing that the equality of these means indicates sampling
from a stationary (posterior) distribution. Consequently, the
Geweke statistic, under this hypothesis, is expected to conform
to a standard normal distribution as it approaches infinity.
The computation of the Z-score assumes the independence of the
two segments of the chain over the long term. Convergence of the
chains was inferred when their respective Geweke statistics fell
within the critical range of -1.96 to 1.96.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Rice, S. O. (1944). Mathematical analysis of random
noise. The Bell System Technical Journal, 23(3), 282-332.</p>
<p>Jeffreys, H. (1946). An invariant form for the prior
probability in estimation problems. Proceedings of the Royal
Society of London. Series A. Mathematical and Physical Sciences,
186(1007), 453-461.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="co"># setting a seed for reproducibility</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">peta</span> <span class="op">&lt;-</span> <span class="fl">6</span>       <span class="co"># eta parameter</span></span></span>
<span class="r-in"><span><span class="va">palpha</span> <span class="op">&lt;-</span> <span class="fl">2</span>       <span class="co"># alpha parameter</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span><span class="fl">30</span>      <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fu">rrice</span><span class="op">(</span><span class="va">n</span>, <span class="va">palpha</span>,<span class="va">peta</span><span class="op">)</span>  <span class="co"># Generates a sample of the Ricci distribution</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in rrice(n, palpha, peta):</span> could not find function "rrice"</span>
<span class="r-in"><span><span class="fu">riccibo</span><span class="op">(</span><span class="va">x</span>,R<span class="op">=</span><span class="fl">5500</span>,burn<span class="op">=</span><span class="fl">500</span>,jump<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in riccibo(x, R = 5500, burn = 500, jump = 5):</span> object 'x' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

