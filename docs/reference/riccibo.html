<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function estimates the parameters of the Ricci distribution from
a sample and using Jeffrey's prior."><title>Parameter estimation of the Ricci distribution using Jeffrey's prior. — riccibo • riccib</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parameter estimation of the Ricci distribution using Jeffrey's prior. — riccibo"><meta property="og:description" content="This function estimates the parameters of the Ricci distribution from
a sample and using Jeffrey's prior."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">riccib</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jeachire/riccib">GitHub</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jeachire/riccib">Source</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Parameter estimation of the Ricci distribution using Jeffrey's prior.</h1>
      
      <div class="d-none name"><code>riccibo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates the parameters of the Ricci distribution from
a sample and using Jeffrey's prior.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">riccibo</span><span class="op">(</span><span class="va">x</span>, <span class="va">R</span>, <span class="va">burn</span>, <span class="va">jump</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A vector of values to which you want to fit the Ricci model.</p></dd>


<dt>R</dt>
<dd><p>Number of samples in the chain (including burned samples).</p></dd>


<dt>burn</dt>
<dd><p>A positive integer specifying number of warmup
samples. This also specifies the number of samples used
for stepsize adaptation, so warmup draws should not be used
for inference. The number of warmup should not be larger than
R.</p></dd>


<dt>jump</dt>
<dd><p>Thinning rate. Must be a positive integer.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing the following estimates:</p>
<dl><dt>acep</dt>
<dd><p>Acceptance rate in the metropolis hastings
algorithm.</p></dd>

<dt>eta</dt>
<dd><p>Point estimate for the eta parameter.</p></dd>

<dt>alpha</dt>
<dd><p>Point estimate for parameter alpha.</p></dd>

<dt>CIL_eta</dt>
<dd><p>Lower limit of the credibility
interval (95%) for the eta parameter.</p></dd>

<dt>CIS_eta</dt>
<dd><p>Upper limit of the credibility
interval (95%) for the eta parameter.</p></dd>

<dt>CIL_alpha</dt>
<dd><p>Lower limit of the credibility
interval (95%) for the alpha parameter.</p></dd>

<dt>CIS_alpha</dt>
<dd><p>Upper limit of the credibility
interval (95%) for the alpha parameter.</p></dd>

<dt>Geweke.statistics</dt>
<dd><p>Z-Statistic of Geweke's
convergence diagnostic.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In this section, we outline the Monte Carlo Markov chain algorithm
for sampling from the joint posterior distribution.  To generate
samples of \(\eta\) and \(\alpha\) from the marginal posterior distribution,
the Metropolis-Hastings (MH) algorithm is required since the marginal
distributions do not have closed-form expressions. Therefore, in order
to obtain samples from the marginal distributions, we can use the
conditional distribution given by</p>
<p>\(
p_1(\eta|\alpha,\boldsymbol{x})\propto \sqrt{(\rho+1)\Psi(\rho)-
   \rho}\prod_{i=1}^{n}I_0\left( \frac{\eta x_i}{\alpha^2}
     \right) \exp\left( -\sum_{i=1}^{n}\frac{x_i^2 + \eta^2}
       {2\alpha^2} \right)\)</p>
<p>\(
p_2(\alpha|\eta,\boldsymbol{x})\propto\frac{\sqrt{(\rho+1)
\Psi(\rho)-\rho}}{\alpha^{2n+2}}\prod_{i=1}^{n}I_0\left( \frac
{\eta x_i}{\alpha^2} \right) \exp\left( -\sum_{i=1}^{n}\frac
{x_i^2 + \eta^2}{2\alpha^2} \right)\)</p>
<p>In this study, we adopt the Gamma distribution
\(q(\alpha^{(*)}|\alpha^{(j)},k)\) y \(q(\eta^{(*)}|\eta^{(j)},d)\)
 as a proposal distribution to sample values of the parameters
 \(\alpha\) and \(\eta\), respectively, where \(d\) and \(k\)
 are hyperparameters that influence the convergence rate of the
 algorithm. It is important to note that alternative proposal
 distributions can be utilized in place of the Gamma model,
 such as any model that generates values in the positive real
 line. The subsequent steps detail the execution of the MH
 algorithm:</p>
<p></p><ol><li><p>Compute the initial values of \(\eta^{(1)}\)
and \(\alpha^{(1)}\) from moment estimators and initialize
a counter \(j=1\);</p></li>
<li><p>Generate a random number \(\eta^{(*)}\) from the
\(Gamma(\eta^{(j)}, d)\) distribution;</p></li>
<li><p>Calculate the acceptance probability, defined as:</p>
<p>\(
\Delta\left(\eta^{(j)},\eta^{(*)}\right)=\min\left(1, \frac
{p_1\left(\eta^{(*)}|\alpha^{(j)},\boldsymbol{x}\right)}
{p_1\left(\eta^{(j)}|\alpha^{(j)},\boldsymbol{x}\right)}
\frac{q\left(\eta^{(j)}|\eta^{(*)},d\right)}{q
\left(\eta^{(*)}|\eta^{(j)},d\right)}\right)\)</p>
<p>Draw a random sample from an independent uniform distribution
\(u\) in the interval (0,1);</p></li>
<li><p>If \(\Delta\left(\eta^{(j)},\eta^{(*)}\right)\geq u(0,1)\),
accept the value \(\eta^{(*)}\) and set
\(\eta^{(j+1)}=\eta^{(*)}\).
If \(\Delta\left(\eta^{(j)},\eta^{(*)}\right)&lt; u(0,1)\),
reject the value and set \(\eta^{(j+1)}=\eta^{(j)}\);</p></li>
<li><p>Generate a random number \(\alpha^{(*)}\) from
the \(Gamma(\alpha^{(j)}, k)\) distribution;</p></li>
<li><p>Calculate the acceptance probability, defined as:
\(
\Delta\left(\alpha^{(j)},\alpha^{(*)}\right)=\min
\left(1, \frac{p_2\left(\alpha^{(*)}|\eta^{(j+1)},
\boldsymbol{x}\right)}{p_2\left(\alpha^{(j)}|\eta^{(j+1)},
\boldsymbol{x}\right)} \frac{q\left(\alpha^{(j)}|
\alpha^{(*)},k\right)}{q\left(\alpha^{(*)}|\alpha^{(j)},k
\right)}\right)\)</p>
<p>Draw a random sample from an independent uniform distribution
\(u\) in the interval (0,1);</p></li>
<li><p>If \(\Delta\left(\alpha^{(j)},\alpha^{(*)}\right)\geq u(0,1)\),
accept the value \(\alpha^{(*)}\) and set
\(\alpha^{(j+1)}=\alpha^{(*)}\).
If \(\Delta\left(\alpha^{(j)},\alpha^{(*)}\right)&lt; u(0,1)\),
reject the value and set \(\alpha^{(j+1)}=\alpha^{(j)}\);</p></li>
<li><p>Increment the counter (j) to (j+1) and repeat steps 2-7
until the chains converge.</p></li>
</ol><p>The implementation of the MCMC methodology detailed previously
facilitated the generation of 5,500 samples from the posterior
distributions. We excluded the initial 500 samples, considering
them as the burn-in phase, and applied a thinning process with
an interval of every 5 samples. This procedure resulted in two
separate chains, each containing \(1000\) samples, which were
utilized to derive the posterior statistical summaries. Initial
values for the simulation were determined using moment
estimators, which are known for their analytical solutions.</p>
<p>To assess the convergence of the Markov chains we produced,
a Geweke diagnostic was employed.
This diagnostic employs a method that compares the mean values
of the first \(10\%\) and the last \(50\%\) of a chain,
positing that the equality of these means indicates sampling
from a stationary (posterior) distribution. Consequently, the
Geweke statistic, under this hypothesis, is expected to conform
to a standard normal distribution as it approaches infinity.
The computation of the Z-score assumes the independence of the
two segments of the chain over the long term. Convergence of the
chains was inferred when their respective Geweke statistics fell
within the critical range of -1.96 to 1.96.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rice, S. O. (1944). Mathematical analysis of random
noise. The Bell System Technical Journal, 23(3), 282-332.</p>
<p>Jeffreys, H. (1946). An invariant form for the prior
probability in estimation problems. Proceedings of the Royal
Society of London. Series A. Mathematical and Physical Sciences,
186(1007), 453-461.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>mcmc</code>: Function for performing MCMC
sampling in the <span class="pkg">MCMCpack</span> package.
<code>Geweke.diag</code>: Function for Geweke's
convergence diagnostic in the <span class="pkg">coda</span> package.
<code>rice</code>: Function for the Rice distribution
in the <span class="pkg">VGAM</span> package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Do not run this R code without first installing and loading the `riccib`</span></span></span>
<span class="r-in"><span><span class="co"># package from the repository https://github.com/jeachire/riccib, as well</span></span></span>
<span class="r-in"><span><span class="co"># as the `coda`, `MCMCpack`, and `VGAM` packages from CRAN.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jeachire/riccib"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">riccib</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"coda"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"coda"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"MCMCpack"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"MCMCpack"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=MCMCpack" class="external-link">MCMCpack</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"VGAM"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"VGAM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/" class="external-link">VGAM</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the riccibo function from the riccib package</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">peta</span> <span class="op">&lt;-</span> <span class="fl">6</span>       <span class="co"># eta parameter</span></span></span>
<span class="r-in"><span><span class="va">palpha</span> <span class="op">&lt;-</span> <span class="fl">2</span>       <span class="co"># alpha parameter</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span><span class="fl">30</span>      <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/riceUC.html" class="external-link">rrice</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">palpha</span>,<span class="va">peta</span><span class="op">)</span>  <span class="co"># Generates a sample of the Ricci distribution</span></span></span>
<span class="r-in"><span><span class="fu">riccibo</span><span class="op">(</span><span class="va">x</span>,R<span class="op">=</span><span class="fl">5500</span>,burn<span class="op">=</span><span class="fl">500</span>,jump<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jesus Achire.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

